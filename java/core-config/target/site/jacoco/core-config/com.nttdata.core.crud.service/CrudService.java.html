<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>CrudService.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">core-config</a> &gt; <a href="../index.html" class="el_bundle">core-config</a> &gt; <a href="index.source.html" class="el_package">com.nttdata.core.crud.service</a> &gt; <span class="el_source">CrudService.java</span></div><h1>CrudService.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright (C) 2023 NTT DATA, All Rights Reserved
 *******************************************************************************/
package com.nttdata.core.crud.service;

import java.io.InputStream;

import org.apache.ibatis.cursor.Cursor;
import org.springframework.transaction.annotation.Transactional;

import com.nttdata.core.common.exception.CoreException;
import com.nttdata.core.common.exception.WrapperRuntimeException;
import com.nttdata.core.common.model.Core;
import com.nttdata.core.common.model.Page;
import com.nttdata.core.common.service.Initializable;
import com.nttdata.core.crud.handler.ExportableCursorHandler;
import com.nttdata.core.crud.handler.ExcelExportableCursorHandler;
import com.nttdata.core.crud.mapper.CrudMapper;
import com.nttdata.core.crud.model.CrudDataLoad;

/**
 * Generic service interface that implements generic method for crud operations.&lt;br&gt;
 * 
 * All methods in this interfaces are marked as @{@link Transactional}
 * 
 * @param &lt;T&gt; Any object extending {@link Core}
 * @author NTT DATA
 * @since 0.0.1
 */
@Transactional
public interface CrudService&lt;T extends Core&lt;?&gt;&gt; extends Initializable&lt;T&gt; {
	
	/**
	 * Persist a new record of T 
	 * 
	 * @param dto the record to persist
	 */
	public default void insert(T dto) {
<span class="nc" id="L39">		this.getMapper().insert(dto);</span>
<span class="nc" id="L40">	}</span>
	
	/**
	 * Updates an existing record
	 * 
	 * @param dto the record to update
	 */
	public default void update(T dto) {
<span class="nc" id="L48">		this.getMapper().update(dto);</span>
<span class="nc" id="L49">	}</span>
	
	/**
	 * Delete an existing record
	 * 
	 * @param dto the record to delete
	 */
	public default void delete(T dto) {
<span class="nc" id="L57">		this.getMapper().delete(dto);</span>
<span class="nc" id="L58">	}</span>
	
	/**
	 * Find a record of T
	 * 
	 * @param dto the record to find
	 * @return T record
	 */
	public default T find(T dto) {
<span class="nc" id="L67">		return this.getMapper().find(dto);</span>
	}
	
	/**
	 * Find all records of T
	 * 
	 * @param dto with search criteria
	 * @return {@link Page} of T that meets the search criteria
	 * @throws CoreException in case of error
	 */
	public default Page&lt;T&gt; search(Page&lt;T&gt; dto) throws CoreException {
<span class="nc" id="L78">		return this.getMapper().search(dto);</span>
	}
	
	/**
	 * Export all records of T.&lt;br&gt;
	 * A default excel handler will be used as handler producing a xlsx inputstream.
	 * 
	 * @param dto {@link Page} of {@link T} with search criteria
	 * @return {@link InputStream} with the exported data in xlsx format
	 * @throws CoreException in case of error
	 */
	public default InputStream export(Page&lt;T&gt; dto) throws CoreException {
<span class="nc" id="L90">		return export(dto, new ExcelExportableCursorHandler&lt;&gt;());</span>
	}
	
	/**
	 * Export all records of T using the requested {@link ExportableCursorHandler}
	 * for the current type T.
	 * 
	 * @param dto {@link Page} of {@link T} with search criteria
	 * @param handler {@link ExportableCursorHandler} the handler used to export the records.
	 * @return {@link InputStream} with the exported data
	 * @throws CoreException in case of error
	 */
	public default InputStream export(Page&lt;T&gt; dto, ExportableCursorHandler&lt;T&gt; handler) throws CoreException {
<span class="nc" id="L103">		return export(dto, handler, (CrudDataLoad) this.init(dto));</span>
	}
	
	/**
	 * Export all records of T using the requested {@link ExportableCursorHandler}
	 * for the current type T.
	 * 
	 * @param dto {@link Page} of {@link T} with search criteria
	 * @param handler {@link ExportableCursorHandler} the handler used to export the records.
	 * 	 When null a Default Excel Handler is used to export the data.
	 * @param dataload {@link CrudDataLoad} with extra data to process the page.
	 * @return {@link InputStream} with the exported data
	 * @throws CoreException in case of error
	 */
	public default InputStream export(Page&lt;T&gt; dto, ExportableCursorHandler&lt;T&gt; handler, CrudDataLoad dataload) throws CoreException {
<span class="nc" id="L118">		try (Cursor&lt;T&gt; cursor = this.getMapper().export(dto)) {</span>
<span class="nc" id="L119">			return handler.export(cursor, dataload);</span>
<span class="nc" id="L120">		} catch (Exception e) {</span>
<span class="nc" id="L121">			throw new WrapperRuntimeException(e);</span>
		}
	}
	
	/**
	 * Get the mapper class associated with the service implementation.
	 * 
	 * @return {@link CrudMapper} of T inside the service
	 */
	CrudMapper&lt;T&gt; getMapper();
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>